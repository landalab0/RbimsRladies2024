<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introducción a Rbims en R</title>
    <meta charset="utf-8" />
    <meta name="author" content="PhD. Stephanie Hereira Pacheco" />
    <meta name="author" content="Karla Paola López Martínez" />
    <meta name="date" content="2024-02-29" />
    <script src="Slides_Intro_files/header-attrs/header-attrs.js"></script>
    <link href="Slides_Intro_files/remark-css/rladies.css" rel="stylesheet" />
    <link href="Slides_Intro_files/remark-css/rladies-fonts.css" rel="stylesheet" />
    <script src="Slides_Intro_files/clipboard/clipboard.min.js"></script>
    <link href="Slides_Intro_files/shareon/shareon.min.css" rel="stylesheet" />
    <script src="Slides_Intro_files/shareon/shareon.min.js"></script>
    <link href="Slides_Intro_files/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="Slides_Intro_files/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="Slides_Intro_files/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="Slides_Intro_files/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <script src="Slides_Intro_files/xaringanExtra_fit-screen/fit-screen.js"></script>
    <link href="Slides_Intro_files/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="Slides_Intro_files/panelset/panelset.css" rel="stylesheet" />
    <script src="Slides_Intro_files/panelset/panelset.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Introducción a Rbims en R
]
.subtitle[
## <img src="figures/Logo-rRbiMs.png" style="width:2in" />
]
.author[
### PhD. Stephanie Hereira Pacheco
]
.author[
### Karla Paola López Martínez
]
.date[
### 2024-02-29
]

---















## <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M40 48C26.7 48 16 58.7 16 72v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zM192 64c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V232c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zM40 368c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24H88c13.3 0 24-10.7 24-24V392c0-13.3-10.7-24-24-24H40z"/></svg> Temario

- Ecología Microbiana

- Genómica y Metagenómica

- Genomas ensamblados a partir de Metagenomas (MAGs)

- Anotación funcional

- Bases de datos

---

# Ecología microbiana
.bg-washed-blue.b--purple.ba.bw2.br3.shadow-5.ph4.mt5[
El estudio de la ecología microbiana comprende desde las células indivuales hasta sistemas complejos de diferentes tipos de microorganismos.

Respondiendo preguntas cómo:

- ¿Qué microorganismos están presentes?

- ¿Cuál es el rol de cada especie?

- ¿Qué interacciones ocurren en el ambiente?

- ¿Cómo los microorganismos cambian el ambiente?


.tr[
 Barton, L. L., &amp; Northup, D. E. (2011).
]]

---

# Genómica 

**La genómica es el estudio de todos los genes de un individuo (condificantes y no), incluyendo las interacciones de estos genes con cada uno y con el ambiente. Cuando hablamos de genómica además de genes, hablamos de: funciones, evolución, mapeo y edición de genomas.** 

.panelset[
.panel[.panel-name[ADN]

El ácido desoxirribonucleico es el compuesto químico que contiene las instrucciones necesarias para desarrollar y dirigir las actividades necesarias de los organismos vivos. 

]

.panel[.panel-name[Genoma]

Es el conjunto completo de ADN se llama su genoma. 

]

.panel[.panel-name[Secuenciación de ADN]

Se refiere a determinar el orden exacto de las bases en una cadena de ADN. La más común es la secuenciación por síntesis donde la ADN-polimerasa se usa para generar una nueva cadena de ADN de una hebra de interés. 

]
]
&lt;img src="https://www.genome.gov/sites/default/files/inline-images/Guide_Genomics_Fact-sheet2020.jpg" width="50%" style="display: block; margin: auto;" /&gt;

---
# Metagenómica

.bg-washed-blue.b--purple.ba.bw2.br3.shadow-5.ph4.mt5[
Es el análisis del ADN genómico de una comunidad completa; esto la diferencia de la genómica, que es el análisis del ADN genómico de un organismo o célula individual. 

De hecho, la traducción más apropiada de "meta" en griego es "más allá", por lo que el término literalmente significa "más allá del estudio del genoma único". 


.tr[
 Handelsman, 1998; Gilbert &amp; Dupont, 2010.
]]


.panelset[
.panel[.panel-name[Cultivables]

Se estima que &lt; 1% de los microorganismos que existen puede ser cultivados 


]

.panel[.panel-name[Observables]

La mayoría son demasiado pequeños para incluso ser observados en microscopio

]

.panel[.panel-name[Secuenciados]

1.6 billones de secuencias nucleotídidas de 450 000 especies formalmente descritas hasta el 2019
 

]
]

---
# MAGs 

####<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M416 0c17.7 0 32 14.3 32 32c0 59.8-30.3 107.5-69.4 146.6c-28 28-62.5 53.5-97.3 77.4l-2.5 1.7c-11.9 8.1-23.8 16.1-35.5 23.9l0 0 0 0 0 0-1.6 1c-6 4-11.9 7.9-17.8 11.9c-20.9 14-40.8 27.7-59.3 41.5H283.3c-9.8-7.4-20.1-14.7-30.7-22.1l7-4.7 3-2c15.1-10.1 30.9-20.6 46.7-31.6c25 18.1 48.9 37.3 69.4 57.7C417.7 372.5 448 420.2 448 480c0 17.7-14.3 32-32 32s-32-14.3-32-32H64c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-59.8 30.3-107.5 69.4-146.6c28-28 62.5-53.5 97.3-77.4c-34.8-23.9-69.3-49.3-97.3-77.4C30.3 139.5 0 91.8 0 32C0 14.3 14.3 0 32 0S64 14.3 64 32H384c0-17.7 14.3-32 32-32zM338.6 384H109.4c-10.1 10.6-18.6 21.3-25.5 32H364.1c-6.8-10.7-15.3-21.4-25.5-32zM109.4 128H338.6c10.1-10.7 18.6-21.3 25.5-32H83.9c6.8 10.7 15.3 21.3 25.5 32zm55.4 48c18.4 13.8 38.4 27.5 59.3 41.5c20.9-14 40.8-27.7 59.3-41.5H164.7z"/></svg>  Los genomas ensamblados en metagenomas (MAG) son genomas microbianos reconstruidos a partir de datos de metagenomas. 

####<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M416 0c17.7 0 32 14.3 32 32c0 59.8-30.3 107.5-69.4 146.6c-28 28-62.5 53.5-97.3 77.4l-2.5 1.7c-11.9 8.1-23.8 16.1-35.5 23.9l0 0 0 0 0 0-1.6 1c-6 4-11.9 7.9-17.8 11.9c-20.9 14-40.8 27.7-59.3 41.5H283.3c-9.8-7.4-20.1-14.7-30.7-22.1l7-4.7 3-2c15.1-10.1 30.9-20.6 46.7-31.6c25 18.1 48.9 37.3 69.4 57.7C417.7 372.5 448 420.2 448 480c0 17.7-14.3 32-32 32s-32-14.3-32-32H64c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-59.8 30.3-107.5 69.4-146.6c28-28 62.5-53.5 97.3-77.4c-34.8-23.9-69.3-49.3-97.3-77.4C30.3 139.5 0 91.8 0 32C0 14.3 14.3 0 32 0S64 14.3 64 32H384c0-17.7 14.3-32 32-32zM338.6 384H109.4c-10.1 10.6-18.6 21.3-25.5 32H364.1c-6.8-10.7-15.3-21.4-25.5-32zM109.4 128H338.6c10.1-10.7 18.6-21.3 25.5-32H83.9c6.8 10.7 15.3 21.3 25.5 32zm55.4 48c18.4 13.8 38.4 27.5 59.3 41.5c20.9-14 40.8-27.7 59.3-41.5H164.7z"/></svg> En los últimos años, se han informado en la literatura miles de MAGs para una variedad de entornos y microbiotas asociadas a un hospedero.

####<svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M416 0c17.7 0 32 14.3 32 32c0 59.8-30.3 107.5-69.4 146.6c-28 28-62.5 53.5-97.3 77.4l-2.5 1.7c-11.9 8.1-23.8 16.1-35.5 23.9l0 0 0 0 0 0-1.6 1c-6 4-11.9 7.9-17.8 11.9c-20.9 14-40.8 27.7-59.3 41.5H283.3c-9.8-7.4-20.1-14.7-30.7-22.1l7-4.7 3-2c15.1-10.1 30.9-20.6 46.7-31.6c25 18.1 48.9 37.3 69.4 57.7C417.7 372.5 448 420.2 448 480c0 17.7-14.3 32-32 32s-32-14.3-32-32H64c0 17.7-14.3 32-32 32s-32-14.3-32-32c0-59.8 30.3-107.5 69.4-146.6c28-28 62.5-53.5 97.3-77.4c-34.8-23.9-69.3-49.3-97.3-77.4C30.3 139.5 0 91.8 0 32C0 14.3 14.3 0 32 0S64 14.3 64 32H384c0-17.7 14.3-32 32-32zM338.6 384H109.4c-10.1 10.6-18.6 21.3-25.5 32H364.1c-6.8-10.7-15.3-21.4-25.5-32zM109.4 128H338.6c10.1-10.7 18.6-21.3 25.5-32H83.9c6.8 10.7 15.3 21.3 25.5 32zm55.4 48c18.4 13.8 38.4 27.5 59.3 41.5c20.9-14 40.8-27.7 59.3-41.5H164.7z"/></svg> Los MAGs nos han ayudado a comprender mejor las poblaciones microbianas y sus interacciones con el entorno donde viven; Además, la mayoría de los MAGs pertenecen a especies nuevas, lo que ayuda a disminuir la llamada materia oscura microbiana. 
 

---
background-image: url(https://raw.githubusercontent.com/Steph0522/Taller_R_Bioinformatica/main/images/meta52.jpg)


background-size: contain

---
background-image: url(https://ars.els-cdn.com/content/image/1-s2.0-S2001037021004931-gr1.jpg)
background-position: 50% 50%


class: right, top

(Yang et al., 2021)

---

# Anotación funcional

Un componente principal del análisis metagenómico es descubrir qué están haciendo realmente los organismos en su muestra. Básicamente es buscar secuencias conocidas que tienen una función asociada o pueden estar relacionadas con una serie de funciones. Algunos enfoques son:

&gt;- Predicción de genes: [MGRAST](https://www.mg-rast.org/), [Prodigal](https://github.com/hyattpd/Prodigal) y  [Prokka](https://github.com/tseemann/prokka).

&gt;- Inferencia funcional asociada al gen marcador: muy útil para la metagenómica dirigida. Puede extrapolar la función si está presente un gen asociado. [MinPath](https://omics.informatics.indiana.edu/MinPath).
&gt;- Análisis de genes marcadores: el enfoque más rápido y sencillo, busque sus lecturas en una base de datos de genes conocidos con función conocida. [HUMAnN2](https://huttenhower.sph.harvard.edu/humann2/), [MEGAN6](https://computomics.com/services/megan6.html) y [SUPER FOCUS](https://github.com/metageni/SUPER-FOCUS).

---

# Bases de datos


.panelset[
.panel[.panel-name[EC]

**Códigos de la Comisión Enzimática:**

- Es una nomenclatura numérica usada para clasificar enzimas basado en las reacciones químicas que catalizan. 

- Como sistema de nomenclatura enzimática, cada número EC está asociado con un nombre recomendado para la reacción catalizada por enzima correspondiente.

- Cada enzima se asigna a un número de cuatro partes, que representa la clase (principal, ej: hidrolasa, ligasa, transferasa, etc.), la subclase (tipo de compuesto, ej: Carbono, Fósforo), la sub-subclase (ej: formil) y el número de entrada (ej: D-Alanina).

- ejemplo: EC.1.2.4.5.

]

.panel[.panel-name[COG]
**Clusters de grupos hortólogos:**


- Es una base de datos que clasifica proteínas en grupos ortólogos, es decir, genes o proteínas que se encuentran en diferentes especies y provienen de un acentro común.



- Cada COG se define como el grupo de tres o más proteínas que son Ortólogas. Han sido desarrollados mediante la comparación, todos contra todos, de secuencias de proteínas codificadas en genomas completos secuenciados, utilizando el programa BLAST.


]

.panel[.panel-name[KO]

**Ortólogos KEGG:** 

- Es una clasificación de genes en función de ortología basada en la enciclopedia de genes y genomas de Kyoto (KEGG). 

- Proporciona una forma de asignar funciones a partir de genes y ayuda a comprender las vías metabólicas y las funciones biológicas a nivel molecular.

]

.panel[.panel-name[dbCAN3]

- Esta base de datos se enfoca en la anotación de enzimas de la clase de hidrólisis de glicosilos (CAZyme), que están involucradas en la degradación y síntesis de carbohidratos. 

- Específicamente, dbCAN se utiliza para identificar y clasificar enzimas CAZyme en secuencias de proteínas.

]


.panel[.panel-name[Interpro]

- [Interpro](https://academic.oup.com/nar/article/51/D1/D418/6814474) proporciona análisis funcional de proteínas clasificándolas en familias y prediciendo dominios y sitios importantes.

- Para clasificar las proteínas de esta manera, InterPro utiliza modelos predictivos, usando varias bases de datos diferentes para producir una poderosa base de datos integrada y una herramienta de diagnóstico:

 + CDD 
 + HAMAP 
 + PANTHER  
 + Pfam 
 + PIRSF 
 + PRINTS 
 + PROSITE 
 + SMART 
 + SFLD 
 + SUPERFAMILY
 + TIGRFAMs 

]


.panel[.panel-name[PICRUSt2]
Es una herramienta de predicción de las funciones metagenómicas con datos de amplicón

 + EC
 + KO
 + Rutas: Metacyc (MinPath)
 + PFAM y TIGRFAMs

]
]

---
# RbiMs 


.bg-washed-blue.b--purple.ba.bw2.br3.shadow-5.ph4.mt5[

Es un paquete de R que nos permite **importar**, **manipular**, **analizar** y **visualizar** los datos obtenidos por varias bases de datos y herramientas de asginación funcional.


]

.bg-washed-green.b--green.ba.bw2.br3.shadow-5.ph4.mt5[

**Ventajas:**

- Reproducibilidad

- Permite definir rutas metabólicas de nuestro interés

- Incluye herramientas de visualización de ggplot2 lo que las hace customizables
]
---

# Funcionamiento de RbiMs

&lt;img src="figures/rbims3.png" width="100%" style="display: block; margin: auto;" /&gt;


---
&lt;img src="figures/rbmis2.jpg" width="100%" style="display: block; margin: auto;" /&gt;



---

# Referencias

- [Rbims](https://github.com/mirnavazquez/RbiMs)
- [Interpro](https://www.ebi.ac.uk/interpro/)
- [dbcan3](https://academic.oup.com/nar/article/51/W1/W115/7147496)
- [PICRUSt2](https://github.com/picrust/picrust2)
- [Barton, L. L., &amp; Northup, D. E. (2011)](https://books.google.com.mx/books?hl=es&amp;lr=&amp;id=51Rt3X9UMfIC&amp;oi=fnd&amp;pg=PR17&amp;dq=Barton,+L.+L.,+%26+Northup,+D.+E.+(2011&amp;ots=F28g5mo8mp&amp;sig=iD1MR12f46fRDfIRiNWJ0q52qzg&amp;redir_esc=y#v=onepage&amp;q=Barton%2C%20L.%20L.%2C%20%26%20Northup%2C%20D.%20E.%20(2011&amp;f=false)
- [Handelsman, 1998; Gilbert &amp; Dupont, 2010](https://www.annualreviews.org/doi/abs/10.1146/annurev-marine-120709-142811)
- [Yang et al., 2021](https://www.sciencedirect.com/science/article/pii/S2001037021004931)
- [astromike.github.io](https://astrobiomike.github.io/genomics/metagen_anvio)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
